<!-- http://railscasts.com/episodes/223-charts?autoplay=true -->

<div id="container" style="width:100%; height:650px;"></div>

<script>
$(function () {
    $('#container').highcharts({
        //chart: { type: 'spline' },

        chart: {
            zoomType: 'xy'//,
        },

        title: { text: 'Temperatur und Luftdruck', x: -20 //center
        },
        // subtitle: { text: 'http://railscasts.com/episodes/223-charts?view=asciicast', x: -20  },
        xAxis: { type: 'datetime' },

        // --- begin yAxis ---
        yAxis: [{ //primary axis
            
          maxPadding:0,
          min : 10, // [°C]
          max : 30, // [°C]
          labels: {
                format: '{value}°C',
                style: {
                    color: Highcharts.getOptions().colors[1]
                }
          },
          title: { text: 'Temperatur (°C)' }
          },{ //secondaty axis
            title: {
                text: 'Druck (mb)'
            },
            min : 1000,
            maxPadding:0,
            labels: {
                format: '{value} mb',
                style: {
                    color: Highcharts.getOptions().colors[0]
                }
            },
           opposite : true
        }],
        // --- end yAxis ---

        tooltip: {
            shared: true
        },

        //legend: {
        //    layout: 'vertical',
        //    align: 'left',
        //    x: 120,
        //    verticalAlign: 'top',
        //    y: 100,
        //    floating: true,
        //    backgroundColor: (Highcharts.theme && Highcharts.theme.legendBackgroundColor) || '#FFFFFF'
        //},

        legend: {
            layout: 'vertical',
            align: 'right',
            verticalAlign: 'middle',
            borderWidth: 0
        },


        // --- begin series ---
        series: [
        {
            name: 'Luftdruck',
            type: 'area',
            yAxis: 1,
            pointInterval: <%= 1.day * 1000 %>,
            pointStart: <%= 3.weeks.ago.at_midnight.to_i * 1000 %>,
            data: <%= SensorsController.get_pressure() %>,
            tooltip: {
                valueSuffix: ' mb'
            }
        }, {
            name: 'Innentemperatur',
            type: 'spline',
            yAxis: 0,
            pointInterval: <%= 1.day * 1000 %>,
            pointStart: <%= 3.weeks.ago.at_midnight.to_i * 1000 %>,
            data: <%= SensorsController.get_temperature() %>,
            tooltip: {
                valueSuffix: ' °C'
            }
        }]
     // --- end series ---
    });
});</script>

<!-- http://stackoverflow.com/questions/13148888/how-to-get-the-current-time-as-13-digit-integer-in-ruby -->
<!-- http://www.jacoulter.com/2012/01/02/rails-highcharts-with-irregular-time-intervals/ -->